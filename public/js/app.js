function SmoothlyMenu(){!$("body").hasClass("mini-navbar")||$("body").hasClass("body-small")?($("#side-menu").hide(),setTimeout(function(){$("#side-menu").fadeIn(400)},200)):$("body").hasClass("fixed-sidebar")?($("#side-menu").hide(),setTimeout(function(){$("#side-menu").fadeIn(400)},100)):$("#side-menu").removeAttr("style")}$(document).ready(function(){function e(){var e=$("body > #wrapper").height()-61;$(".sidebard-panel").css("min-height",e+"px");var t=$("nav.navbar-default").height(),i=$("#page-wrapper").height();t>i&&$("#page-wrapper").css("min-height",t+"px"),t<i&&$("#page-wrapper").css("min-height",$(window).height()+"px"),$("body").hasClass("fixed-nav")&&(t>i?$("#page-wrapper").css("min-height",t+"px"):$("#page-wrapper").css("min-height",$(window).height()-60+"px"))}$(this).width()<769?$("body").addClass("body-small"):$("body").removeClass("body-small"),$("#side-menu").metisMenu(),$(".collapse-link").on("click",function(){var e=$(this).closest("div.ibox"),t=$(this).find("i");e.children(".ibox-content").slideToggle(200),t.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),e.toggleClass("").toggleClass("border-bottom"),setTimeout(function(){e.resize(),e.find("[id^=map-]").resize()},50)}),$(".close-link").on("click",function(){$(this).closest("div.ibox").remove()}),$(".fullscreen-link").on("click",function(){var e=$(this).closest("div.ibox"),t=$(this).find("i");$("body").toggleClass("fullscreen-ibox-mode"),t.toggleClass("fa-expand").toggleClass("fa-compress"),e.toggleClass("fullscreen"),setTimeout(function(){$(window).trigger("resize")},100)}),$(".navbar-minimalize").on("click",function(e){e.preventDefault(),$("body").toggleClass("mini-navbar"),SmoothlyMenu()}),e(),$(window).bind("load",function(){$("body").hasClass("fixed-sidebar")&&$(".sidebar-collapse").slimScroll({height:"100%",railOpacity:.9})}),$(window).bind("load resize scroll",function(){$("body").hasClass("body-small")||e()}),$(".full-height-scroll").slimscroll({height:"100%"})}),$(window).bind("resize",function(){$(this).width()<769?$("body").addClass("body-small"):$("body").removeClass("body-small")}),jQuery(document).ready(function(e){function t(){var t=new FormData(document.getElementById("keywords-form")),i=e("input[name=_project_id]").val();e.post({url:"/projects/"+i+"/prefill",processData:!1,contentType:!1,data:t})}function i(){var t=new FormData(document.getElementById("quiz-form")),i=e("input[name=_project_id]").val();e.post({url:"/projects/"+i+"/prefill",processData:!1,contentType:!1,data:t})}function o(){var t=this;e.get("/projects/"+p+"/get_stored_files",{collection:t.options.paramName},function(e){e.forEach(function(e){t.emit("addedfile",e),n(e,t),t.emit("complete",e)})})}function a(t){e.get("/projects/"+t.model_id+"/remove_stored_file/"+t.id),t.previewElement.remove()}function s(e,t){var i=this,o=t[0];e.id=o.id,e.url=o.url,e.model_id=o.model_id,e.mime_type=o.mime_type,n(e,i)}function n(e,t){switch(e.mime_type){case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":t.options.thumbnail.call(t,e,"/img/docx.png");break;case"application/pdf":t.options.thumbnail.call(t,e,"/img/pdf.png");break;case"image/jpg":case"image/jpeg":case"image/png":case"image/gif":t.options.thumbnail.call(t,e,e.url);break;default:t.options.thumbnail.call(t,e,"/img/file.png")}}function r(){var t=this;e.get("/ideas/"+idea_id+"/get_stored_idea_files",{collection:t.options.paramName},function(e){e.forEach(function(e){t.emit("addedfile",e),n(e,t),t.emit("complete",e)})})}function l(t){e.get("/ideas/"+t.model_id+"/remove_stored_file/"+t.id),t.previewElement.remove()}e(".head-notification").show(0).delay(5e3).hide(150),e(".subscribe-btn").on("click",function(){var t=e(this).attr("data-amount"),i=e(this).attr("data-plan");e("#plan_id").val(i),e(".amount").html(t),e("#stripe-form-wrapper").show(),e("html, body").animate({scrollTop:e(document).height()-e(window).height()})});var d=e("#payment-form");d.on("submit",function(t){t.preventDefault(),Stripe.setPublishableKey(stripe_pub),Stripe.createToken({number:e(".card-number").val(),cvc:e(".card-cvc").val(),exp_month:e(".card-expiry-month").val(),exp_year:e(".card-expiry-year").val()},function(t,i){if(i.error)e(".error").removeClass("hide").find(".alert").text(i.error.message);else{var o=i.id;d.find("input[type=text]").empty(),d.append("<input type='hidden' name='stripeToken' value='"+o+"'/>"),d.get(0).submit()}})});var c=e("#update-card-form");c.on("submit",function(t){t.preventDefault(),Stripe.setPublishableKey(stripe_pub),Stripe.createToken({number:e(".card-number").val(),cvc:e(".card-cvc").val(),exp_month:e(".card-expiry-month").val(),exp_year:e(".card-expiry-year").val()},function(t,i){if(i.error)e(".error").removeClass("hide").find(".alert").text(i.error.message);else{var o=i.id;e("#stripeToken").val(o),c.unbind("submit"),c.submit()}})}),e("#quiz-form").steps({bodyTag:"fieldset",enableAllSteps:"client"!=user.role,showFinishButtonAlways:"client"!=user.role,autoFocus:!1,onInit:function(e,t){"undefined"!=typeof Storage&&void 0!==localStorage.getItem("quiz-form-step")&&jQuery("#quiz-form-t-"+localStorage.getItem("quiz-form-step")).click();for(var i=document.getElementsByClassName("js-switch"),o=0;o<i.length;o++)new Switchery(i[o],{color:"#1AB394"})},onStepChanging:function(t,o,a){if(o>a)return i(),!0;var s=e("#quiz-form");return o<a&&(s.find(".body:eq("+a+") label.error").remove(),s.find(".body:eq("+a+") .error").removeClass("error")),e.validator.addMethod("tagsInput",function(t,i){return!(e("#themes option:selected").size()<10)},"Please fill at least 10 themes"),0===o&&s.validate({rules:{"themes[]":{tagsInput:!0}},messages:{"themes[]":"Please fill at least 10 themes"}}),s.validate().settings.ignore=":disabled,:hidden:not('#themes')",!!s.valid()&&(i(),!0)},onStepChanged:function(e,t){"undefined"!=typeof Storage&&localStorage.setItem("quiz-form-step",t)},onFinishing:function(e,t){return window.onbeforeunload=function(){},i(),!0},onFinished:function(t,i){e(this).submit()}});var m=[];e("#keywords-form").steps({bodyTag:"fieldset",enableAllSteps:!0,showFinishButtonAlways:"client"!=user.role,autoFocus:!1,labels:{loading:"Loading related keywords..."},onInit:function(e,t){"undefined"!=typeof Storage&&void 0!==localStorage.getItem("keywords-form-step")&&jQuery("#keywords-form-t-"+localStorage.getItem("keywords-form-step")).click()},onStepChanging:function(e,i){return t(),!0},onStepChanged:function(e,t){"undefined"!=typeof Storage&&localStorage.setItem("keywords-form-step",t)},onFinishing:function(e,i){return t(),!0},onContentLoaded:function(){for(var t=document.getElementsByClassName("autoheight"),i=0;i<t.length;i++)t[i].addEventListener("onload",function(){var e=this;setTimeout(function(){e.style.cssText="height:auto; padding:0",e.style.cssText="height:"+e.scrollHeight+"px"},0)},!1);e("input[name=_project_id]").val();e(".i-checks").iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green"});for(var o=document.getElementsByClassName("js-switch"),i=0;i<o.length;i++)new Switchery(o[i],{color:"#1AB394"});m.forEach(function(e){e.off(),e.destroy()});var a=new Dropzone("div#meta-"+idea_id+"-files",{url:"/ideas/"+idea_id+"/prefill_meta_files",paramName:"files",method:"POST",headers:{"X-CSRF-TOKEN":e('meta[name="csrf-token"]').attr("content")},addRemoveLinks:!0,init:r,success:s,removedfile:l});m.push(a)},onFinished:function(t,i){e(this).submit()}}),e(document).on("click","button.keyword-input-submit",function(t){t.preventDefault();var i=e(this).attr("data-theme"),o=e('input[data-theme="'+i+'"]').val();if(o){e('div.keywords-wrapper[data-theme="'+i+'"]').append('<div class="col-xs-4 col-sm-4 col-md-4 col-lg-4"><div class="i-checks"><label><input class="keywords-checkbox" checked type="checkbox" name="keywords['+i+"]["+o+']" value="true"> <i></i>'+o+"</label></div></div>"),e('input[data-theme="'+i+'"]').val(""),e(".i-checks").iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green"})}}),e(document).on("click","button.keyword-question-input-submit",function(t){t.preventDefault();var i=e(this).attr("data-question-theme"),o=e('input[data-question-theme="'+i+'"]').val();if(o){e('div.keywords-wrapper[data-question-theme="'+i+'"]').append('<div class="col-xs-4 col-sm-4 col-md-4 col-lg-4"><div class="i-checks"><label><input class="keywords-checkbox" checked type="checkbox" name="keywords_questions['+i+"]["+o+']" value="true"> <i></i>'+o+"</label></div></div>"),e('input[data-question-theme="'+i+'"]').val(""),e(".i-checks").iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green"})}}),e(".tagsinput").tagsinput({tagClass:"label label-primary"});var u=e("#themes");u.on("itemAdded",function(t){e("#themes-order-list-wrapper").removeClass("hide"),e("#themes-order-list").append('<li class="list-group-item" data-value="'+t.item+'">'+t.item+"</li>");var i=e("#themes-order-list").sortable("toArray",{attribute:"data-value"});e("#themes_order option").remove(),i.forEach(function(t){e("#themes_order").append('<option selected="selected" value="'+t+'">'+t+"</option>")})}),u.on("itemRemoved",function(t){e('.list-group-item[data-value="'+t.item+'"]').remove(),e("#themes_order option[value='"+t.item+"']").remove();var i=e("#themes-order-list").sortable("toArray",{attribute:"data-value"});e("#themes_order").val(i.join()),""==u.val()&&e("#themes-order-list-wrapper").addClass("hide")}),e("#themes-order-list").sortable({axis:"y",cursor:"move",placeholder:"sortable-placeholder",forcePlaceholderSize:!0,opacity:.8,stop:function(t,i){var o=e("#themes-order-list").sortable("toArray",{attribute:"data-value"});e("#themes_order option").remove(),o.forEach(function(t){e("#themes_order").append('<option selected="selected" value="'+t+'">'+t+"</option>")})}}),e(".footable").footable({paging:{enabled:!0}}),e(".i-checks").iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green"}),Echo.private("App.User."+user.id).notification(function(t){if("App\\Notifications\\Chat\\Message"==t.type)if(conversation_id!=t.conversation_id){e("#topnav-messages-list").prepend(t.navbar_message);var i=e("#message-notifications-count"),o=parseInt(i.html());o&&!isNaN(o)||(o=0),o+=1,i.html(o.toString()),toastr.options={closeButton:!0,debug:!1,progressBar:!0,preventDuplicates:!1,positionClass:"toast-top-right",showDuration:"400",hideDuration:"1000",timeOut:"7000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};var a="New message from: "+t.sender_name;toastr.info(t.message_text.substring(0,25)+"...",a)}else e.get("{{url('messages/read/')}}/"+t.conversation_id);else if(t.hasOwnProperty("navbar_message")){e("#topnav-alerts-list").prepend(t.navbar_message);var s=e("#alerts-notifications-count"),o=parseInt(s.html());o&&!isNaN(o)||(o=0),o+=1,s.html(o.toString())}}),help_video_src&&e("#help-video-wrapper").show(),e(".question-btn").click(function(){var t=e(this);swal(t.attr("data-name"),{className:"help-video-alert",buttons:{cancel:!1,confirm:{text:"Got it"}},content:{element:"iframe",attributes:{className:"help-video",src:t.attr("data-player"),frameborder:"0",allowfullscreen:"allowfullscreen"}}}).then(function(){e(".help-video").each(function(){return e(this).attr("src",e(this).attr("src")),!1})})});var p=e("input[name=_project_id]").val();e("#compliance_guideline-group").dropzone({url:"/projects/"+p+"/prefill_files",paramName:"compliance_guideline",method:"POST",headers:{"X-CSRF-TOKEN":e('meta[name="csrf-token"]').attr("content")},addRemoveLinks:!0,init:o,success:s,removedfile:a}),e("#logo-group").dropzone({url:"/projects/"+p+"/prefill_files",paramName:"logo",method:"POST",headers:{"X-CSRF-TOKEN":e('meta[name="csrf-token"]').attr("content")},addRemoveLinks:!0,init:o,success:s,removedfile:a}),e("#article_images-group").dropzone({url:"/projects/"+p+"/prefill_files",paramName:"article_images",method:"POST",headers:{"X-CSRF-TOKEN":e('meta[name="csrf-token"]').attr("content")},addRemoveLinks:!0,init:o,success:s,removedfile:a}),e("#ready_content-group").dropzone({url:"/projects/"+p+"/prefill_files",paramName:"ready_content",method:"POST",headers:{"X-CSRF-TOKEN":e('meta[name="csrf-token"]').attr("content")},addRemoveLinks:!0,init:o,success:s,removedfile:a})});